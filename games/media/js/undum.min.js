!function(){!function(){function ready(t){"loading"!=document.readyState?t():document.addEventListener("DOMContentLoaded",t)}Function.prototype.inherits=function(t){var e={},i=this.prototype=new t;return this.prototype.uber=function(n){n in e||(e[n]=0);var r,a,o=e[n],s=t.prototype;if(o){for(;o;)s=s.constructor.prototype,o-=1;r=s[n]}else r=i[n],r==this[n]&&(r=s[n]);return e[n]+=1,a=r.apply(this,Array.prototype.slice.apply(arguments,[1])),e[n]-=1,a},this};var hasLocalStorage=function(){var t=!1;try{t="localStorage"in window&&null!==window.localStorage&&void 0!==window.localStorage}catch(e){t=!1}return t},isMobileDevice=function(){return navigator.userAgent.toLowerCase().search(/iphone|ipad|palm|blackberry|android/)>=0||document.querySelectorAll("html").offsetWidth<=640},showBlock=function(t){var e=t;if("string"==typeof t)var e=document.getElementById(t);e.classList.add("show"),e.classList.remove("hide"),e.style.display="block"},hideBlock=function(t){if("string"==typeof t)var e=document.getElementById(t);if("element"==typeof t)var e=t;e.classList.add("hide"),e.classList.remove("show")},AssertionError=function(t){this.message=t,this.name=AssertionError};AssertionError.inherits(Error);var assert=function(t,e){if(!t)throw new AssertionError(e)},extend=function(t){t=t||{};for(var e=1;e<arguments.length;e++){var i=arguments[e];if(i)for(var n in i)i.hasOwnProperty(n)&&("object"==typeof i[n]?extend(t[n],i[n]):t[n]=i[n])}return t},Situation=function(t){t?(t.enter&&(this._enter=t.enter),t.act&&(this._act=t.act),t.exit&&(this._exit=t.exit),this._optionText=t.optionText,this._canView=t.canView||!0,this._canChoose=t.canChoose||!0,this._priority=void 0!==t.priority?t.priority:1,this._frequency=void 0!==t.frequency?t.frequency:1,this._displayOrder=void 0!==t.displayOrder?t.displayOrder:1,this.tags=void 0!==t.tags?Array.isArray(t.tags)?t.tags:t.tags.split(/[ \t,]+/):[]):(this._canView=!0,this._canChoose=!0,this._priority=1,this._frequency=1,this._displayOrder=1,this.tags=[])};Situation.prototype.enter=function(t,e,i){this._enter&&this._enter(t,e,i)},Situation.prototype.act=function(t,e,i){this._act&&this._act(t,e,i)},Situation.prototype.exit=function(t,e,i){this._exit&&this._exit(t,e,i)},Situation.prototype.canView=function(t,e,i){return"function"==typeof this._canView?this._canView(t,e,i):this._canView},Situation.prototype.canChoose=function(t,e,i){return"function"==typeof this._canChoose?this._canChoose(t,e,i):this._canChoose},Situation.prototype.optionText=function(t,e,i){return"function"==typeof this._optionText?this._optionText(t,e,i):this._optionText},Situation.prototype.choiceData=function(t,e,i){return{priority:this._priority,frequency:this._frequency,displayOrder:this._displayOrder}};var SimpleSituation=function(t,e){Situation.call(this,e),this.content=t,this.heading=e&&e.heading,this.actions=e&&e.actions,this.choices=e&&e.choices,this.minChoices=e&&e.minChoices,this.maxChoices=e&&e.maxChoices};SimpleSituation.inherits(Situation),SimpleSituation.prototype.enter=function(t,e,i){if(this.heading&&e.writeHeading("function"==typeof this.heading?this.heading():this.heading),this._enter&&this._enter(t,e,i),this.content&&e.write("function"==typeof this.content?this.content():this.content),this.choices){var n=e.getSituationIdChoices(this.choices,this.minChoices,this.maxChoices);e.writeChoices(n)}},SimpleSituation.prototype.act=function(t,e,i){var n=this.actions[i];try{n(t,e,i)}catch(r){n&&e.write(n)}this._act&&this._act(t,e,i)},SimpleSituation.prototype.optionText=function(t,e,i){var n=Situation.prototype.optionText.call(this,t,e,i);return void 0===n?this.heading:n};var QualityDefinition=function(t,e){var i=extend(e,{priority:t,group:null,extraClasses:null});this.title=t,this.priority=i.priority,this.group=i.group,this.extraClasses=i.extraClasses};QualityDefinition.prototype.format=function(t,e){return e.toString()};var IntegerQuality=function(t,e){QualityDefinition.call(this,t,e)};IntegerQuality.inherits(QualityDefinition),IntegerQuality.prototype.format=function(t,e){return Math.floor(e).toString()};var NonZeroIntegerQuality=function(t,e){IntegerQuality.call(this,t,e)};NonZeroIntegerQuality.inherits(IntegerQuality),NonZeroIntegerQuality.prototype.format=function(t,e){return 0===e?null:IntegerQuality.prototype.format.call(this,t,e)};var NumericQuality=function(t,e){QualityDefinition.call(this,t,e)};NumericQuality.inherits(QualityDefinition);var WordScaleQuality=function(t,e,i){var n=extend(i,{offset:null,useBonuses:!0});QualityDefinition.call(this,t,i),this.values=e,this.offset=n.offset,this.useBonuses=n.useBonuses};WordScaleQuality.inherits(QualityDefinition),WordScaleQuality.prototype.format=function(t,e){var i=Math.floor(e-this.offset),n="";return 0>i?(n=i.toString(),i=0):i>=this.values.length&&(n="+"+(i-this.values.length+1).toString(),i=this.values.length-1),this.useBonuses||(n=""),null===this.values[i]?null:this.values[i]+n};var FudgeAdjectivesQuality=function(t,e){WordScaleQuality.call(this,t,["terrible".l(),"poor".l(),"mediocre".l(),"fair".l(),"good".l(),"great".l(),"superb".l()],e),"offset"in e||(this.offset=-3)};FudgeAdjectivesQuality.inherits(WordScaleQuality);var OnOffQuality=function(t,e){var i=extend(e,{onDisplay:""});QualityDefinition.call(this,t,e),this.onDisplay=i.onDisplay};OnOffQuality.inherits(QualityDefinition),OnOffQuality.prototype.format=function(t,e){return e?this.onDisplay:null};var YesNoQuality=function(t,e){var i=extend(e,{yesDisplay:"yes".l(),noDisplay:"no".l()});QualityDefinition.call(this,t,e),this.yesDisplay=i.yesDisplay,this.noDisplay=i.noDisplay};YesNoQuality.inherits(QualityDefinition),YesNoQuality.prototype.format=function(t,e){return e?this.yesDisplay:this.noDisplay};var QualityGroup=function(t,e){var i=extend(e,{priority:t,extraClasses:null});this.title=t,this.priority=i.priority,this.extraClasses=i.extraClasses},System=function(){this.rnd=null,this.time=0};System.prototype.clearContent=function(t){var e;t&&(e=document.querySelectorAll(t)),e||(e=document.getElementById("content")),e.innerHTML=""},System.prototype.write=function(t,e){doWrite(t,e)},System.prototype.writeHeading=function(t,e){var i=document.createElement("<h1>");i.innerHTML=t,doWrite(i,e)},System.prototype.writeBefore=function(t,e){doWrite(t,e,"prepend","before")},System.prototype.writeInto=function(t,e){doWrite(t,e,"append","append")},System.prototype.replaceWith=function(t,e){doWrite(t,e,"replaceWith","replaceWith")},System.prototype.doLink=function(t){processLink(t)},System.prototype.clearLinks=function(t){var e=document.querySelectorAll("a[href='"+t+"']");Array.prototype.forEach.call(e,function(t,e){t.querySelectorAll("span").classList.add("ex_link")})},System.prototype.writeChoices=function(t,e){if(0!==t.length){for(var i=getCurrentSituation(),n=document.getElementById("content").querySelectorAll("ul").classList.add("options"),r=0;r<t.length;++r){var a=t[r],o=game.situations[a];assert(o,"unknown_situation".l({id:a}));var s=o.optionText(character,this,i);s||(s="choice".l({number:r+1}));var l,u=document.getElementById("content").querySelectorAll("li");l=o.canChoose(character,this,i)?"<a href='"+a+"'>"+s+"</a>":"<span>"+s+"</span>",u.innerHTML=l,n.appendChild(u)}doWrite(n,e,"append","after")}},System.prototype.getSituationIdChoices=function(t,e,i){var n,r;"string"==Object.prototype.toString.call(t).replace(/^\[object (.+)\]$/,"$1").toLowerCase()&&(t=[t]);var a={};for(r=0;r<t.length;++r){var o=t[r];if("#"==o.substr(0,1))for(var s=getSituationIdsWithTag(o.substr(1)),l=0;l<s.length;++l)a[s[l]]=!0;else a[o]=!0}var u=getCurrentSituation(),c=[];for(var d in a){var h=game.situations[d];if(assert(h,"unknown_situation".l({id:d})),h.canView(character,system,u)){var p=h.choiceData(character,system,u);p.id=d,c.push(p)}}c.sort(function(t,e){return e.priority-t.priority});var f,y=[],m=[];for(r=0;r<c.length;++r){if(n=c[r],n.priority!=f){if(void 0!==f&&(void 0===e||r>=e))break;y.push.apply(y,m),m=[],f=n.priority}m.push(n)}var g=y.length+m.length;if(void 0===i||i>=g)y.push.apply(y,m);else if(i>=y.length);else{var v=i-y.length;for(r=0;r<m.length;++r)n=m[r],n._frequencyValue=this.rnd.random()/n.frequency;v.sort(function(t,e){return t._frequencyValue-e._frequencyValue});var S=v.slice(0,v);y.push.apply(y,S)}y.sort(function(t,e){return t.displayOrder-e.displayOrder});var _=[];for(r=0;r<y.length;++r)_.push(y[r].id);return _},System.prototype.setCharacterText=function(t){var e=document.getElementById("character_text_content"),i=(e.innerHTML,augmentLinks(t));interactive&&e.offsetWidth>0&&e.offsetHeight>0?(hideBlock(e),e.innerHTML=i,showBlock(e),showHighlight(e.parent)):e.innerHTML=i},System.prototype.setQuality=function(t,e){var i=character.qualities[t];if(character.qualities[t]=e,interactive){var n,r=game.qualities[t];if(r){n=r.format(character,e);var a=document.getElementById("#q_"+t);if(a.length<=0){if(null===n)return;a=addQualityBlock(t).hide().fadeIn(500)}else{if(i==e)return;if(null===n){var o=null,s=a.parents(".quality_group");o=s.find(".quality").length<=1?s:a,o.fadeOut(1e3,function(){o.remove()})}else{var l=a.find("[data-attr='value']");l.fadeOut(250,function(){l.html(n),l.fadeIn(750)})}}showHighlight(a)}}},System.prototype.animateQuality=function(t,e,i){var n=character.qualities[t];if(n||(n=0),this.setQuality(t,e),interactive){var r={from:0,to:1,title:null,showValue:!0,displayValue:null,leftLabel:null,rightLabel:null};n>e&&(r.from=1,r.to=0),extend(i,r);var a=game.qualities[t];a&&(null===r.displayValue&&(r.displayValue=a.format(character,e)),null===r.title&&(r.title=a.title));var o=496,s=document.getElementById("progress_bar").cloneNode(!0);s.setAttribute("id",void 0);var l=s.find("[data-attr='width']");l.css("width",r.from*o);var u=s.find("[data-attr='name']"),c=s.find("[data-attr='value']"),d=s.find("[data-attr='left_label']"),h=s.find("[data-attr='right_label']");r.title?u.html(r.title):u.remove(),r.showValue&&null!==r.displayValue?c.html(r.displayValue):c.remove(),r.leftLabel?d.html(r.leftLabel):d.remove(),r.rightLabel?h.html(r.rightLabel):h.remove(),document.getElementById("content").appendChild(s),setTimeout(function(){l.animate({width:r.to*o},1e3,function(){setTimeout(function(){mobile?s.fadeOut(1500,function(){$(this).remove()}):s.animate({opacity:0},1500).slideUp(500,function(){$(this).remove()})},2e3)})},500)}};var Character=function(){this.qualities={},this.sandbox={}},game={situations:{},start:"start",qualities:{},qualityGroups:{},init:null,enter:null,afterEnter:null,beforeAction:null,afterAction:null,exit:null},system=new System,progress={seed:null,sequence:[],saveTime:null},current=null,character=null,interactive=!0,mobile=isMobileDevice(),startTime,linkStack=null,getCurrentSituation=function(){return current?game.situations[current]:null},parse=function(t){return void 0===t?t:parseFloat(t)},parseList=function(t,e){return void 0===t||null===t?e?void 0:[]:t.split(/[ ,\t]+/)},parseFn=function(str){if(void 0===str)return str;var fstr="(function(character, system, situation) {\n"+str+"\n})",fn=eval(fstr);return fn},loadHTMLSituations=function(){var t=document.querySelectorAll("div.situation");Array.prototype.forEach.call(t,function(t){var e=t.getAttribute("id");assert(void 0===game.situations[e],"existing_situation".l({id:e}));var i=t.innerHTML,n={optionText:t.getAttribute("data-option-text"),canView:parseFn(t.getAttribute("data-can-view")),canChoose:parseFn(t.getAttribute("data-can-choose")),priority:parse(t.getAttribute("data-priority")),frequency:parse(t.getAttribute("data-frequency")),displayOrder:parse(t.getAttribute("data-display-order")),tags:parseList(t.getAttribute("data-tags"),!1),heading:t.getAttribute("data-heading"),choices:parseList(t.getAttribute("data-choices"),!0),minChoices:parse(t.getAttribute("data-min-choices")),maxChoices:parse(t.getAttribute("data-max-choices"))};game.situations[e]=new SimpleSituation(i,n)})},doWrite=function(t,e){continueOutputTransaction();var i,n=augmentLinks(t);e&&(i=document.querySelector(e)),i&&(dimensions=i.getBoundingClientRect(),console.log(dimensions),window.scroll(0,150)),i?i.appendChild(n):document.getElementById("content").innerHTML=n},getSaveId=function(){return"undum_"+game.id+"_"+game.version},showQualities=function(){document.getElementById("qualities").innerHTML="";for(var t in character.qualities)addQualityBlock(t)},showHighlight=function(t){var e=t.querySelector(".highlight");e.length<=0&&(e=document.createElement("<div></div>").classList.add("highlight"),t.appendChild(e)),showBlock(e),setTimeout(function(){hideBlock(e)},2e3)},insertAtCorrectPosition=function(t,e){var i=e.getAttribute("data-priority"),n=t.children;if(void 0!=n){for(var r=0;r<n.length;r++){var a=n[r];if(i<a.getAttribute("data-priority"))return void a.before(e)}t.appendChild(e)}},addGroupBlock=function(t){var e=game.qualityGroups[t],i=document.getElementById("quality_group").cloneNode(!0);i.setAttribute("id","g_"+t),i.setAttribute("data-priority",e.priority);var n=i.querySelectorAll("[data-attr='title']");if(e.title?n.innerHTML=e.title:void 0!=n.parentNode&&n.parentNode.removeChild(n),e.extraClasses)for(var r=0;r<e.extraClasses.length;r++)i.addClass(e.extraClasses[r]);var a=document.getElementById("qualities");return insertAtCorrectPosition(a,i),i},addQualityBlock=function(t){var e=game.qualities[t];if(!e)throw new Error("Can't display a quality that hasn't been defined: "+t);var i=e.title,n=e.format(character,character.qualities[t]);if(null===n)return null;var r=document.getElementById("quality").cloneNode(!0);if(r.setAttribute("id","q_"+t),r.setAttribute("data-priority",e.priority),r.querySelectorAll("[data-attr='name']").innerHTML=i,r.querySelectorAll("[data-attr='value']").innerHTML=n,e.extraClasses)for(var a=0;a<e.extraClasses.length;a++)r.className.add(e.extraClasses[a]);var o,s=e.group;if(s){var l=game.qualityGroups[s];assert(l,"no_group_definition".l({id:s})),o=document.getElementById("g_"+s),(null==o||o.length<=0)&&(o=addGroupBlock(s))}var u=o.querySelectorAll(".qualities_in_group");return insertAtCorrectPosition(u,r),r},scrollStack=[],pendingFirstWrite=!1,startOutputTransaction=function(){0===scrollStack.length&&(pendingFirstWrite=!0),scrollStack.push($("#content").height()+$("#title").height()+60)},continueOutputTransaction=function(){if(pendingFirstWrite){pendingFirstWrite=!1;var t=$("#ui_library #turn_separator").clone();t.removeAttr("id"),$("#content").append(t)}},endOutputTransaction=function(){var t=scrollStack.pop();0===scrollStack.length&&null!==t&&(interactive&&!mobile&&$("body, html").animate({scrollTop:t},500),t=null)},linkRe=/^([a-z0-9_-]+|\.)(\/([0-9a-z_-]+))?$/,processLink=function(t){if(null!==linkStack)return void linkStack.push(t);for(startOutputTransaction(),linkStack=[],processOneLink(t);linkStack.length>0;)t=linkStack.shift(),processOneLink(t);linkStack=null,endOutputTransaction(),$("#save").attr("disabled",!1)},processOneLink=function(t){var e=t.match(linkRe);assert(e,"link_not_valid".l({link:t}));var i=e[1],n=e[3];if("."!==i?i!==current&&doTransitionTo(i):assert(n,"link_no_action".l()),n&&(i=getCurrentSituation())){if(game.beforeAction){var r=game.beforeAction(character,system,current,n);r!==!0&&i.act(character,system,n)}else i.act(character,system,n);game.afterAction&&game.afterAction(character,system,current,n)}},processClick=function(t){var e=.001*(new Date).getTime();system.time=e-startTime,progress.sequence.push({link:t,when:system.time}),processLink(t)},doTransitionTo=function(t){var e=current,i=getCurrentSituation(),n=game.situations[t];if(assert(n,"unknown_situation".l({id:t})),i){i.exit(character,system,t),game.exit&&game.exit(character,system,e,t),$("#content a").each(function(t,e){var i=$(e);i.hasClass("sticky")||i.attr("href").match(/[?&]sticky[=&]?/)||i.replaceWith($("<span>").addClass("ex_link").html(i.html()))});var r=$("#content .transient, #content ul.options");r.add($("#content a").filter(function(){return this.attr("href").match(/[?&]transient[=&]?/)})),interactive?mobile?r.fadeOut(2e3):r.animate({opacity:0},1500).slideUp(500,function(){$(this).remove()}):r.remove()}current=t,game.enter&&game.enter(character,system,e,t),n.enter(character,system,e),game.afterEnter&&game.afterEnter(character,system,e,t)},augmentLinks=function(t){output=document.createElement("div"),output.innerHTML=t;var e=output.querySelectorAll("a");return Array.prototype.forEach.call(e,function(t,e){var i=t.getAttribute("href");(!t.classList.contains("raw")||i.match(/[?&]raw[=&]?/))&&(i.match(linkRe)?t.addEventListener("click",function(e){return e.preventDefault(),(t.classList.contains("once")||i.match(/[?&]once[=&]?/))&&system.clearLinks(i),processClick(i),!1}):t.classList.add("raw"))}),output.innerHTML},doErase=function(t){var e=getSaveId();localStorage[e]&&(t||confirm("erase_message".l()))&&(delete localStorage[e],document.getElementById("erase").setAttribute("disabled",!0),startGame())},getSituationIdsWithTag=function(t){var e=[];for(var i in game.situations)for(var n=game.situations[i],r=0;r<n.tags.length;++r)if(n.tags[r]==t){e.push(i);break}return e},initGameDisplay=function(){document.getElementById("content").innerHTML="";var t=getCurrentSituation();assert(t,"no_current_situation".l()),showQualities()},startGame=function(){progress.seed=(new Date).toString(),character=new Character,system.rnd=new Random(progress.seed),progress.sequence=[{link:game.start,when:0}],document.getElementById("content").innerHTML="",startTime=.001*(new Date).getTime(),system.time=0,game.init&&game.init(character,system),showQualities(),doTransitionTo(game.start)},saveGame=function(){var t=.001*(new Date).getTime();progress.saveTime=t-startTime,localStorage[getSaveId()]=JSON.stringify(progress),document.getElementById("erase").setAttribute("disabled",!1),document.getElementById("save").setAttribute("disabled",!0)},loadGame=function(t){progress=t,character=new Character,system.rnd=new Random(progress.seed),document.getElementById("content").innerHTML="",showQualities(),game.init&&game.init(character,system),interactive=!1;for(var e=0;e<progress.sequence.length;e++){var i=progress.sequence[e];system.time=i.when,processLink(i.link)}interactive=!0;var n=.001*(new Date).getTime();startTime=n-progress.saveTime,showQualities()};window.undum={Situation:Situation,SimpleSituation:SimpleSituation,QualityDefinition:QualityDefinition,IntegerQuality:IntegerQuality,NonZeroIntegerQuality:NonZeroIntegerQuality,NumericQuality:NumericQuality,WordScaleQuality:WordScaleQuality,FudgeAdjectivesQuality:FudgeAdjectivesQuality,OnOffQuality:OnOffQuality,YesNoQuality:YesNoQuality,QualityGroup:QualityGroup,game:game,isInteractive:function(){return interactive},language:{}},ready(function(){if(loadHTMLSituations(),hasLocalStorage()){var t=document.getElementById("erase");t.addEventListener("click",doErase()),t.addEventListener("keydown",doErase());var e=document.getElementById("save");e.addEventListener("click",saveGame),e.addEventListener("keydown",saveGame);var i=localStorage[getSaveId()];if(i)try{loadGame(JSON.parse(i)),e.setAttribute("disabled",!0),t.setAttribute("disabled",!1)}catch(n){doErase(!0)}else e.setAttribute("disabled",!0),t.setAttribute("disabled",!0),startGame()}else $(".buttons").html("<p>"+"no_local_storage".l()+"</p>"),startGame();document.getElementById("click_message").style.display="",document.getElementById("title").addEventListener("click",function(){showBlock("content"),showBlock("content_wrapper"),showBlock("legal"),showBlock("tools_wrapper"),document.getElementById("title").style.cursor="default",hideBlock("click_message")})}),function(){var t={},e=function(e){var i=t[e];if(i)return i;i=[],e in undum.language&&i.push(e);for(var n=e.split("-"),r=n.length-2;r>0;r--){var a=n.slice(0,r).join("-");a in undum.language&&i.push(a)}return i.push(""),t[e]=i,i},i=function(t,e){var i=undum.language[t];return i?i[e]:null},n=function(t,n){for(var r,a,o=e(t),s=0;s<o.length;s++)if(a=o[s],r=i(a,n))return r;return n};String.prototype.l=function(t){var e=document.querySelector("html").getAttribute("lang")||"",i=n(e,this);if(t)for(var r in t)i=i.replace(new RegExp("\\{"+r+"\\}"),t[r]);return i}}();var Random=function(){var t=256,e=6,i=52,n=Math.pow(t,e),r=Math.pow(2,i),a=2*r,o=function(i){if(this.random=null,!i)throw{name:"RandomSeedError",message:"random_seed_error".l()};var o=[];l(i,o);var u=new s(o);this.random=function(){for(var i=u.g(e),o=n,s=0;r>i;)i=(i+s)*t,o*=t,s=u.g(1);for(;i>=a;)i/=2,o/=2,s>>>=1;return(i+s)/o}},s=function(e){var i,n,r=this,a=e.length,o=0,s=r.i=r.j=r.m=0;for(r.S=[],r.c=[],a||(e=[a++]);t>o;)r.S[o]=o++;for(o=0;t>o;o++)i=r.S[o],s=u(s+i+e[o%a]),n=r.S[s],r.S[o]=n,r.S[s]=i;r.g=function(e){var i=r.S,n=u(r.i+1),a=i[n],o=u(r.j+a),s=i[o];i[n]=s,i[o]=a;for(var l=i[u(a+s)];--e;)n=u(n+1),a=i[n],o=u(o+a),s=i[o],i[n]=s,i[o]=a,l=l*t+i[u(a+s)];return r.i=n,r.j=o,l},r.g(t)},l=function(t,e){t+="";for(var i=0,n=0;n<t.length;n++){var r=u(n);i^=e[r],e[r]=u(19*i+t.charCodeAt(n))}t="";for(n in e)t+=String.fromCharCode(e[n]);return t},u=function(e){return e&t-1};return o}();Random.prototype.random=function(){throw{name:"RandomError",message:"random_error".l()}},Random.prototype.randomInt=function(t,e){return t+Math.floor((e-t+1)*this.random())},Random.prototype.dice=function(t,e,i){for(var n=0,r=0;t>r;r++)n+=this.randomInt(1,e);return i&&(n+=i),n},Random.prototype.aveDice=function(){var t=[2,3,3,4,4,5];return function(e,i){for(var n=0,r=0;e>r;r++)n+=t[this.randomInt(0,5)];return i&&(n+=i),n}}(),Random.prototype.diceString=function(){var t=/^([1-9][0-9]*)?d([%FA]|[1-9][0-9]*)([-+][1-9][0-9]*)?$/;return function(e){var i=e.match(t);if(!i)throw new Error("dice_string_error".l({string:e}));var n,r=i[1]?parseInt(i[1],10):1,a=i[3]?parseInt(i[3],10):0;switch(i[2]){case"A":return this.aveDice(r,a);case"F":n=3,a-=2*r;break;case"%":n=100;break;default:n=parseInt(i[2],10)}return this.dice(r,n,a)}}();var en={terrible:"terrible",poor:"poor",mediocre:"mediocre",fair:"fair",good:"good",great:"great",superb:"superb",yes:"yes",no:"no",choice:"Choice {number}",no_group_definition:"Couldn't find a group definition for {id}.",link_not_valid:"The link '{link}' doesn't appear to be valid.",link_no_action:"A link with a situation of '.', must have an action.",unknown_situation:"You can't move to an unknown situation: {id}.",existing_situation:"You can't override situation {id} in HTML.",erase_message:"This will permanently delete this character and immediately return you to the start of the game. Are you sure?",no_current_situation:"I can't display, because we don't have a current situation.",no_local_storage:"No local storage available.",random_seed_error:"You must provide a valid random seed.",random_error:"Initialize the Random with a non-empty seed before use.",dice_string_error:"Couldn't interpret your dice string: '{string}'."};undum.language[""]=en,undum.language.en=en}()}();